<!DOCTYPE html>
<html>
<head>
    <title>Debug Network</title>
</head>
<body>
    <h1>Debug de Rede - Health Guardian</h1>
    <div id="results"></div>
    <button onclick="testConnections()">Testar Conex√µes</button>
    <button onclick="clearCache()">Limpar Cache</button>
    
    <script>
        function log(message) {
            const results = document.getElementById('results');
            results.innerHTML += '<p>' + new Date().toLocaleTimeString() + ': ' + message + '</p>';
        }
        
        async function testConnections() {
            document.getElementById('results').innerHTML = '';
            
            // Testar diferentes portas
            const ports = [3000, 3001, 5000];
            
            for (const port of ports) {
                try {
                    log(`Testando localhost:${port}...`);
                    const response = await fetch(`http://localhost:${port}/`, { 
                        method: 'GET',
                        mode: 'no-cors'
                    });
                    log(`‚úÖ localhost:${port} - Resposta recebida`);
                } catch (error) {
                    log(`‚ùå localhost:${port} - Erro: ${error.message}`);
                }
            }
            
            // Testar API espec√≠fica
            try {
                log('Testando API Health...');
                const response = await fetch('http://localhost:5000/api/health');
                const data = await response.json();
                log(`‚úÖ API Health - Status: ${data.status}`);
            } catch (error) {
                log(`‚ùå API Health - Erro: ${error.message}`);
            }
            
            // Verificar localStorage
            log('Verificando localStorage...');
            const authData = localStorage.getItem('auth-storage');
            if (authData) {
                log(`üì¶ Auth Storage encontrado: ${authData.substring(0, 100)}...`);
            } else {
                log('üì¶ Nenhum auth storage encontrado');
            }
        }
        
        function clearCache() {
            // Limpar localStorage
            localStorage.clear();
            sessionStorage.clear();
            log('üßπ Cache limpo - localStorage e sessionStorage');
            
            // Tentar limpar cache do service worker se existir
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(function(registrations) {
                    for(let registration of registrations) {
                        registration.unregister();
                        log('üßπ Service Worker removido');
                    }
                });
            }
        }
        
        // Auto-executar ao carregar
        window.onload = function() {
            testConnections();
        };
    </script>
</body>
</html>