/* UI overrides: theme-consistent colors and subtle focus outlines
 *
 * Connector: Imported after index.css in main.jsx to ensure higher cascade precedence
 * IA prompt: "Normalize warning/yellow tints to theme accent and soften focus outlines"
 */

/* 1) Remove yellow/amber usage in favor of theme accent (blue on light, green/teal on dark) */
/* Buttons */
.light-mode .btn-warning {
  @apply bg-blue-600/10 hover:bg-blue-600/20 border-blue-600/20 hover:border-blue-500 text-blue-600 focus:ring-blue-500/30;
}
.dark-mode .btn-warning {
  @apply bg-emerald-600/20 hover:bg-emerald-600/30 border-emerald-600/30 hover:border-emerald-500 text-emerald-400 focus:ring-emerald-500/40;
}

/* Common yellow/amber utility remaps used across calculators/badges */
/* Text */
.light-mode .text-yellow-800, .light-mode .text-amber-700 { @apply text-blue-700; }
.light-mode .text-yellow-600, .light-mode .text-amber-600 { @apply text-blue-600; }
.light-mode .text-yellow-500, .light-mode .text-amber-500 { @apply text-blue-600; }
.dark-mode .text-yellow-400, .dark-mode .text-amber-400 { @apply text-emerald-400; }
.dark-mode .text-yellow-300, .dark-mode .text-amber-300 { @apply text-emerald-300; }
.dark-mode .text-yellow-200, .dark-mode .text-amber-200 { @apply text-emerald-300; }

/* Backgrounds */
.light-mode .bg-yellow-50, .light-mode .bg-amber-50 { @apply bg-blue-50; }
.light-mode .bg-amber-100, .light-mode .bg-amber-100\/80 { @apply bg-blue-100/80; }
.light-mode .bg-yellow-100, .light-mode .bg-yellow-100\/80 { @apply bg-blue-100/80; }
.light-mode .bg-yellow-600\/20, .light-mode .bg-amber-600\/20 { @apply bg-blue-600/20; }
.dark-mode .bg-yellow-900\/20, .dark-mode .bg-amber-900\/20 { @apply bg-emerald-900/20; }
.dark-mode .bg-yellow-600\/20, .dark-mode .bg-amber-600\/20 { @apply bg-emerald-600/20; }

/* Borders */
.light-mode .border-yellow-400, .light-mode .border-amber-300 { @apply border-blue-300; }
.light-mode .border-yellow-400\/50, .light-mode .border-amber-300\/50 { @apply border-blue-300/50; }
.light-mode .border-yellow-600\/30, .light-mode .border-amber-600\/30 { @apply border-blue-600/30; }
.dark-mode .border-yellow-400, .dark-mode .border-amber-400 { @apply border-emerald-400; }
.dark-mode .border-yellow-700\/50, .dark-mode .border-amber-700\/50 { @apply border-emerald-700/50; }
.dark-mode .border-yellow-600\/30, .dark-mode .border-amber-600\/30 { @apply border-emerald-600/30; }

/* Rings (focus) */
.light-mode .focus\:ring-yellow-500\/50:focus, .light-mode .focus\:ring-amber-500\/50:focus { @apply ring-blue-500/40; }
.dark-mode .focus\:ring-yellow-500\/50:focus, .dark-mode .focus\:ring-amber-500\/50:focus { @apply ring-emerald-500/40; }

/* 2) Subtle, theme-colored focus outlines for generic div and anchor elements */
/* Goal: replace thick/white outlines with a thin, accent-tinted halo */
.dark-mode a:focus, .dark-mode a:focus-visible, .dark-mode div:focus, .dark-mode div:focus-visible {
  outline: none !important;
  /* Use accent-rgb defined in themes.css: teal in dark mode */
  box-shadow: 0 0 0 1px rgb(var(--accent-rgb) / 0.25) !important;
  border-color: rgb(var(--accent-rgb) / 0.20) !important;
}
.light-mode a:focus, .light-mode a:focus-visible, .light-mode div:focus, .light-mode div:focus-visible {
  outline: none !important;
  /* Use accent-rgb defined in themes.css: blue in light mode */
  box-shadow: 0 0 0 1px rgb(var(--accent-rgb) / 0.22) !important;
  border-color: rgb(var(--accent-rgb) / 0.18) !important;
}

/* Ensure anchor and div don't get oversized ring widths from defaults */
.dark-mode a:focus-visible, .dark-mode div:focus-visible,
.light-mode a:focus-visible, .light-mode div:focus-visible {
  --tw-ring-offset-width: 0 !important;
  --tw-ring-color: rgb(var(--accent-rgb) / 0.25) !important;
  --tw-ring-offset-color: transparent !important;
}

/* 3) Theme border utility: subtle, accent-tinted borders per mode
 * Connector: Consumed by Dashboard cards and patient list where class `theme-border` is used.
 * Rationale: Avoid default white borders; make 1px delicate, greenish (dark) and bluish (light)
 */
.dark-mode .theme-border {
  border-color: rgb(var(--accent-rgb) / 0.22) !important; /* teal tint */
}
.light-mode .theme-border {
  border-color: rgb(var(--accent-rgb) / 0.18) !important; /* blue tint */
}

/* Escopo específico: impedir borda branca em <div> da página de Perfil */
.dark-mode .profile-page div.border {
  border-color: rgb(var(--accent-rgb) / 0.22) !important;
}
.light-mode .profile-page div.border {
  border-color: rgb(var(--accent-rgb) / 0.18) !important;
}

/* ---------------------------------------------------------
 * Utilities: background fill for "second" divs
 *
 * Purpose: Provide easy classes to color only the second div or all even divs
 * within a container, using the app theme tokens and allowing per-instance
 * overrides via a CSS variable.
 *
 * Default color: var(--theme-card)
 * Override per container: add style="--theme-fill-bg: var(--theme-background)"
 *
 * Connector: Intended to be used by React components as a class on container
 * elements (e.g., cards, panels, lists) when design requires highlighting the
 * second item. Works with both dark and light modes automatically.
 * IA prompt: "Provide theme-aware utilities to style the 2nd child div and even
 * div siblings across components, with minimal specificity and easy overrides"
 * --------------------------------------------------------- */

/* Fill only the 2nd div at multiple nesting depths (up to 4 levels) */
.theme-fill-seconds {
  /* Consumers can override this per container if needed */
  --theme-fill-bg: var(--theme-card);
}
.theme-fill-seconds > div:nth-child(2),
.theme-fill-seconds > * > div:nth-child(2),
.theme-fill-seconds > * > * > div:nth-child(2),
.theme-fill-seconds > * > * > * > div:nth-child(2) {
  background-color: var(--theme-fill-bg);
}

/* Fill every even direct child div (2nd, 4th, ...) */
.theme-fill-even-divs {
  --theme-fill-bg: var(--theme-card);
}
.theme-fill-even-divs > div:nth-child(2n) {
  background-color: var(--theme-fill-bg);
}

/* ---------------------------------------------------------
 * Utilities (bright mode only): background fill for 3rd and 5th divs
 *
 * Goal: Provide opt-in, low-specificity helpers to color only the 3rd and/or 5th
 * child divs inside a container when in light/bright mode, without affecting
 * dark mode or globally overriding component backgrounds.
 *
 * Default color: var(--color-bg-light) (semantic light surface)
 * Overrides: set style="--theme-fill-bg: var(--theme-background)" per container
 *
 * Connector: Attach these classes to layout containers (e.g., dashboard panels,
 * record viewer sections). They play well with existing tokens and avoid
 * unintended cascading.
 * IA prompt: "In light-mode, offer pragmatic nth-child utilities (3rd, 5th) to
 * ease theme adjustments while keeping consistency and avoiding duplicates"
 * --------------------------------------------------------- */

/* Bright mode fix: all four dashboard structures should be light gray like other surfaces */
.light-mode .center-pane .patient-dashboard-panel,
.light-mode .center-pane .patient-dashboard-card {
  background-color: var(--color-bg-light) !important;
}
.light-mode .theme-fill-thirds { --theme-fill-bg: var(--color-bg-light); }
.light-mode .theme-fill-thirds > div:nth-child(3),
.light-mode .theme-fill-thirds > * > div:nth-child(3),
.light-mode .theme-fill-thirds > * > * > div:nth-child(3),
.light-mode .theme-fill-thirds > * > * > * > div:nth-child(3) {
  background-color: var(--theme-fill-bg);
}

/* Fill the 5th div (up to 4 nesting levels) in light-mode */
.light-mode .theme-fill-fifths { --theme-fill-bg: var(--color-bg-light); }
.light-mode .theme-fill-fifths > div:nth-child(5),
.light-mode .theme-fill-fifths > * > div:nth-child(5),
.light-mode .theme-fill-fifths > * > * > div:nth-child(5),
.light-mode .theme-fill-fifths > * > * > * > div:nth-child(5) {
  background-color: var(--theme-fill-bg);
}

/* Copy the 3rd div background to the 5th div (light-mode only) */
.light-mode .theme-fill-copy-3-to-5 { --theme-fill-3-bg: var(--color-bg-light); }
.light-mode .theme-fill-copy-3-to-5 > div:nth-child(3),
.light-mode .theme-fill-copy-3-to-5 > * > div:nth-child(3),
.light-mode .theme-fill-copy-3-to-5 > * > * > div:nth-child(3),
.light-mode .theme-fill-copy-3-to-5 > * > * > * > div:nth-child(3),
.light-mode .theme-fill-copy-3-to-5 > div:nth-child(5),
.light-mode .theme-fill-copy-3-to-5 > * > div:nth-child(5),
.light-mode .theme-fill-copy-3-to-5 > * > * > div:nth-child(5),
.light-mode .theme-fill-copy-3-to-5 > * > * > * > div:nth-child(5) {
  background-color: var(--theme-fill-3-bg);
}

/* 6) Div blue tint utility (light mode only)
 * Purpose: Allow specific <div> elements to use the same bluish tone as light-mode buttons
 * Scope: Only applies when .light-mode is present and only to <div> with .button-tint
 * Connector: Use this class in React components where a non-button element should visually match button tint
 * IA prompt: "Apply button-like blue tint to specific divs in light mode without altering dark mode"
 */
.light-mode div.button-tint {
  /* Minimal, surgical: background tint only to avoid layout/typography side-effects */
  @apply bg-blue-600/20;
}

.light-mode div.button-tint:hover {
  /* Match the hover depth used by .btn-primary in light mode */
  @apply bg-blue-600/30;
}

/* 7) Native button theme styling
 * Purpose: Apply theme-colored fills to native HTML <button> elements
 * Scope: Only applies to buttons that don't already have specific background classes
 * Connector: Ensures native buttons in calculators and modals match theme colors
 * IA prompt: "Style native buttons with theme colors while preserving existing custom styles"
 */
/* Narrow scope: avoid icon-only buttons (any button that contains an SVG)
   Exclude calendar-day buttons to respect agenda-specific backgrounds. */
.light-mode button:not([class*="bg-"]):not(.btn):not([class*="button-"]):not(.calendar-day):not(:has(svg)) {
  @apply bg-blue-600 text-white hover:bg-blue-700 transition-colors;
}

.dark-mode button:not([class*="bg-"]):not(.btn):not([class*="button-"]):not(.calendar-day):not(:has(svg)) {
  @apply bg-emerald-600 text-white hover:bg-emerald-700 transition-colors;
}

/* For buttons that have some styling but need theme colors */
.light-mode button.theme-button {
  @apply bg-blue-600 text-white hover:bg-blue-700 transition-colors;
}

.dark-mode button.theme-button {
  @apply bg-emerald-600 text-white hover:bg-emerald-700 transition-colors;
}

/* 8) Exceptions: transparent buttons with theme foreground text/icon
 * Purpose: Allow specific native buttons to remain transparent in both modes
 * Behavior: Text and icons are white in dark, black in light (via explicit colors)
 */
.light-mode button.button-exception, .light-mode .button-exception {
  background-color: transparent !important;
  color: #000000 !important; /* bright mode: black */
  border-color: transparent !important;
}
.dark-mode button.button-exception, .dark-mode .button-exception {
  background-color: transparent !important;
  color: #ffffff !important; /* dark mode: white */
  border-color: transparent !important;
}
/* Ensure SVG icons inherit the current text color without filling shapes */
.button-exception svg { stroke: currentColor; }
.button-exception svg path { stroke: currentColor; fill: none; }
